<div class="max-w-xl mx-auto p-4 space-y-4">
    <div class="rounded-xl shadow p-6 space-y-4">
        <!-- STEP 1 -->
        @if(step === 1) {
        <div>
            <label class="block mb-1 font-semibold">プロバイダーを選択</label>
            <select (change)="onProviderChange($event)" class="w-full border rounded p-2">
                @for( key of keyvalue(providerTemplates); track $index) {
                <option [value]="key.key" [selected]="provider === key.key">
                    {{ key.key }}
                </option>
                }
            </select>
        </div>

        <div>
            <label class="block mb-1 font-semibold">この情報を{{ provider }}に登録してください</label>
            <div class="p-3 rounded text-sm space-y-2">
                <div class="flex items-center justify-between">
                    <p><strong>Redirect URI:</strong> {{ providerTemplates[provider].redirectUri }}</p>
                    <button (click)="copyToClipboard(providerTemplates[provider].redirectUri)"
                        class="text-blue-600 hover:underline">コピー</button>
                </div>
                <div>
                    <p><strong>Scope候補:</strong></p>
                    <ul class="list-disc list-inside ml-4">
                        @for(s of providerTemplates[provider].scopes; track $index) {
                        <code>{{ s || '(空)' }}</code>
                        }
                    </ul>
                </div>
            </div>
        </div>

        <button (click)="step = 2" class="mt-4 px-4 py-2 rounded">次へ</button>
        }

        <!-- STEP 2 -->
        @if(step === 2){
        <div>
            <label class="block mb-1">URI Base</label>
            <input type="text" class="w-full border rounded p-2" formControlName="uriBase" />
        </div>

        <div>
            <label class="block mb-1">Client ID</label>
            <input type="text" class="w-full border rounded p-2" formControlName="clientId" />
        </div>

        <div>
            <label class="block mb-1">Client Secret</label>
            <input type="password" class="w-full border rounded p-2" formControlName="clientSecret" />
        </div>

        <div>
            <label class="block mb-1">Scope</label>
            <input type="text" class="w-full border rounded p-2" formControlName="scope" />
        </div>

        <div>
            <label class="block mb-1">Redirect URI</label>
            <input type="text" class="w-full border rounded p-2" [value]="providerTemplates[provider].redirectUri"
                readonly />
        </div>

        <div class="flex items-center space-x-2">
            <input type="checkbox" id="requireMailAuth" formControlName="requireMailAuth" />
            <label for="requireMailAuth">メール認証を要求する</label>
        </div>

        <div class="flex space-x-2 mt-4">
            <button (click)="step = 1" class="bg-gray-300 px-4 py-2 rounded">戻る</button>
            <button (click)="submit()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">保存</button>
        </div>
        }
    </div>
</div>